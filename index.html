<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>投資再平衡助手 - 專業版</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="dashboard-container" id="mainContainer">
      <aside
        class="bg-white border-r border-rose-100 flex flex-col p-5 overflow-y-auto"
      >
        <div class="mb-10 text-center pt-8">
          <h1 class="text-3xl font-black text-rose-500 tracking-tighter">
            <i class="fas fa-heart mr-2"></i>REBALANCE
          </h1>
          <p
            class="text-[11px] text-rose-400 font-black mt-1 uppercase tracking-[0.3em]"
          >
            Precision Control
          </p>
        </div>

        <div class="flex-1 space-y-3" id="accountList"></div>

        <div class="mt-8 pt-6 border-t border-rose-100">
          <button
            id="btnCreateAccount"
            class="w-full py-4 rounded-xl bg-rose-50 text-rose-700 font-black hover:bg-rose-100 transition-all flex items-center justify-center gap-2 text-lg"
          >
            <i class="fas fa-plus-circle"></i> 新增計畫
          </button>
        </div>
      </aside>

      <main class="flex flex-col min-h-screen bg-[#fffafb]">
        <div class="flex items-center justify-between mb-8">
          <div class="flex items-center gap-6">
            <button
              id="btnToggleSidebar"
              class="flex items-center justify-center w-14 h-14 bg-white text-rose-500 border-2 border-rose-100 rounded-2xl shadow-sm hover:bg-rose-50 transition-all"
            >
              <i id="toggleIcon" class="fas fa-chevron-left text-2xl"></i>
            </button>

            <div class="flex flex-col">
              <h2
                id="activeAccountTitle"
                class="text-5xl font-black text-rose-900 flex items-center gap-4 cursor-pointer hover:text-rose-600 transition-colors"
              >
                載入中...
              </h2>
            </div>
          </div>

          <div class="flex items-center gap-4">
            <button
              id="btnExport"
              class="px-6 py-3 bg-white border border-emerald-200 text-emerald-700 font-black rounded-xl hover:bg-emerald-50 transition-all flex items-center gap-2 shadow-sm"
            >
              <i class="fas fa-file-export"></i> 匯出
            </button>
            <label
              class="px-6 py-3 bg-white border border-amber-200 text-amber-700 font-black rounded-xl hover:bg-amber-50 cursor-pointer transition-all flex items-center gap-2 shadow-sm"
            >
              <i class="fas fa-file-import"></i> 匯入
              <input
                type="file"
                id="inputImport"
                class="hidden"
                accept=".xlsx"
              />
            </label>
            <button
              id="btnDeleteAccount"
              class="p-3 text-rose-200 hover:text-rose-600 transition-all"
            >
              <i class="fas fa-trash-alt text-3xl"></i>
            </button>
          </div>
        </div>

        <div class="dashboard-grid mb-8">
          <div class="glass-card border-t-[6px] border-t-rose-500">
            <span
              class="text-lg font-black text-rose-600 uppercase tracking-widest"
              >帳戶淨值</span
            >
            <div
              id="totalNetValue"
              class="mt-1 font-mono-data tracking-tighter text-rose-950"
            >
              $0
            </div>
          </div>
          <div class="glass-card border-t-[6px] border-t-pink-500">
            <span
              class="text-lg font-black text-pink-700 uppercase tracking-widest"
              >總曝險額</span
            >
            <div
              id="totalExposure"
              class="mt-1 font-mono-data tracking-tighter text-pink-950"
            >
              $0
            </div>
          </div>
          <div class="glass-card border-t-[6px] border-t-amber-500">
            <span
              class="text-lg font-black text-amber-700 uppercase tracking-widest"
              >實質槓桿</span
            >
            <div
              id="leverageDisplay"
              class="mt-1 font-mono-data text-amber-800"
            >
              1.00x
            </div>
          </div>
          <div class="glass-card border-t-[6px] border-t-rose-600">
            <span
              class="text-lg font-black text-rose-800 uppercase tracking-widest flex items-center gap-2"
            >
              預算總計 <span id="levBadge" class="badge-lev hidden">LEV</span>
            </span>
            <div
              id="targetTotalRatio"
              class="mt-1 font-mono-data text-rose-950"
            >
              0.0%
            </div>
          </div>
          <div
            class="glass-card border-t-[6px] border-t-indigo-600"
            id="maintenanceCard"
          >
            <span
              class="text-lg font-black text-indigo-700 uppercase tracking-widest"
              >質押維持率</span
            >
            <div
              id="maintenanceRatio"
              class="mt-1 font-mono-data text-indigo-900"
            >
              N/A
            </div>
          </div>
        </div>

        <div class="mb-8">
          <div class="params-row py-6 border-y border-rose-100">
            <div class="flex-1">
              <label class="text-lg font-black text-rose-400 mb-2 block"
                >貸款/負債 (Loan)</label
              >
              <div class="relative">
                <span
                  class="absolute left-0 bottom-1 text-rose-300 font-black text-3xl"
                  >$</span
                >
                <input
                  type="number"
                  id="debtInput"
                  class="underline-input pl-8 font-mono-data"
                  placeholder="0"
                />
              </div>
            </div>
            <div class="flex-1">
              <label class="text-lg font-black text-rose-400 mb-2 block"
                >現金餘額 (Cash)</label
              >
              <div class="relative">
                <span
                  class="absolute left-0 bottom-1 text-rose-300 font-black text-3xl"
                  >$</span
                >
                <input
                  type="number"
                  id="cashInput"
                  class="underline-input pl-8 font-mono-data"
                  placeholder="0"
                />
              </div>
            </div>
            <div class="w-32">
              <label
                class="text-lg font-black text-rose-400 mb-2 block text-center"
                >美金匯率</label
              >
              <input
                type="number"
                id="usdRateInput"
                class="underline-input text-center font-mono-data"
                step="0.1"
              />
            </div>
            <div class="h-16 w-px bg-rose-100 mx-4"></div>
            <div class="w-36">
              <label
                class="text-lg font-black text-rose-400 mb-2 block text-center"
                >絕對門檻 %</label
              >
              <input
                type="number"
                id="rebalanceAbsInput"
                class="underline-input text-center font-mono-data"
                step="0.1"
              />
            </div>
            <div class="w-36">
              <label
                class="text-lg font-black text-rose-400 mb-2 block text-center"
                >相對門檻 %</label
              >
              <input
                type="number"
                id="rebalanceRelInput"
                class="underline-input text-center font-mono-data"
                step="0.1"
              />
            </div>
          </div>
        </div>

        <div class="flex-1">
          <div class="flex justify-between items-center mb-8">
            <h3 class="text-3xl font-black text-rose-900 tracking-tight">
              <i class="fas fa-layer-group mr-4 text-rose-500"></i>標的實時監控
            </h3>
            <div class="flex items-center gap-4">
              <button
                id="btnSyncAll"
                class="px-8 py-4 bg-white border-2 border-rose-300 text-rose-700 font-black rounded-2xl hover:bg-rose-50 transition-all flex items-center gap-3 shadow-sm"
              >
                <i id="syncIcon" class="fas fa-sync-alt"></i> 更新報價
              </button>
              <button
                id="btnAddAsset"
                class="px-10 py-4 btn-pink rounded-2xl shadow-xl flex items-center gap-3"
              >
                <i class="fas fa-plus"></i> 新增標的
              </button>
            </div>
          </div>

          <table class="w-full">
            <thead>
              <tr class="text-left">
                <th class="px-2 col-symbol">標的 / 名稱</th>
                <th class="px-2 col-leverage text-center">槓桿</th>
                <th class="px-2 col-price">目前單價</th>
                <th class="px-2 col-shares">持有股數</th>
                <th class="px-2 col-nominal">名目曝險</th>
                <th class="px-2 col-ratio text-center text-indigo-700">
                  目前%
                </th>
                <th class="px-2 col-ratio text-center text-rose-800">目標%</th>
                <th class="px-2 col-target text-center">理想配置</th>
                <th class="px-2 col-suggest text-center">再平衡建議</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="assetBody"></tbody>
          </table>
        </div>
      </main>
    </div>

    <div
      id="toast"
      class="fixed bottom-10 right-10 px-10 py-5 bg-rose-950 text-white rounded-2xl shadow-2xl opacity-0 transition-all z-50 pointer-events-none flex items-center gap-4 font-black text-xl"
    >
      <i class="fas fa-bell text-rose-400"></i> <span id="toastMsg"></span>
    </div>

    <script type="module" src="main.js"></script>
  </body>
</html>
