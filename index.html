<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>再平衡終端 - 全螢幕大氣版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="dashboard-container" id="mainContainer">
      <aside class="bg-white flex flex-col p-5 overflow-y-auto">
        <div class="mb-10 text-center pt-8">
          <h1 class="text-3xl font-black text-rose-500 tracking-tighter">
            <i class="fas fa-heart mr-2"></i>REBALANCE
          </h1>
          <p
            class="text-[11px] text-rose-400 font-black mt-1 uppercase tracking-[0.3em]"
          >
            Precision Control
          </p>
        </div>
        <div class="flex-1 space-y-3" id="accountList"></div>
        <div class="mt-8 pt-6 border-t">
          <button
            id="btnCreateAccount"
            class="w-full py-4 rounded-xl bg-rose-50 text-rose-700 font-black hover:bg-rose-100 flex items-center justify-center gap-2 text-lg"
          >
            <i class="fas fa-plus-circle"></i> 新增計畫
          </button>
        </div>
      </aside>

      <main class="bg-[#fffafb] flex flex-col">
        <div class="flex items-center justify-between mb-8">
          <div class="flex items-center gap-6">
            <button
              id="btnToggleSidebar"
              class="w-12 h-12 flex items-center justify-center bg-white border-2 border-rose-100 rounded-xl text-rose-500 hover:bg-rose-50 transition-all"
            >
              <i id="toggleIcon" class="fas fa-chevron-left text-lg"></i>
            </button>
            <h2
              id="activeAccountTitle"
              class="text-5xl font-black text-rose-900 cursor-pointer hover:text-rose-600 transition-colors"
            >
              載入中...
            </h2>
          </div>
          <div class="flex items-center gap-4">
            <button
              id="btnExport"
              class="px-6 py-3 bg-white border border-emerald-200 text-emerald-700 font-black rounded-xl hover:bg-emerald-50 shadow-sm"
            >
              <i class="fas fa-file-export"></i> 匯出
            </button>
            <label
              class="px-6 py-3 bg-white border border-amber-200 text-amber-700 font-black rounded-xl cursor-pointer flex items-center gap-2 shadow-sm"
              ><i class="fas fa-file-import"></i> 匯入<input
                type="file"
                id="inputImport"
                class="hidden"
                accept=".xlsx"
            /></label>
            <button
              id="btnDeleteAccount"
              class="p-3 text-rose-200 hover:text-rose-600"
            >
              <i class="fas fa-trash-alt text-3xl"></i>
            </button>
          </div>
        </div>

        <div class="dashboard-grid mb-6">
          <div class="glass-card border-t-[6px] border-t-rose-500">
            <span>帳戶淨值</span>
            <div id="totalNetValue" class="font-mono-data">$0</div>
          </div>
          <div class="glass-card border-t-[6px] border-t-pink-500">
            <span>總曝險額</span>
            <div id="totalExposure" class="font-mono-data">$0</div>
          </div>
          <div class="glass-card border-t-[6px] border-t-amber-500">
            <span>實質槓桿</span>
            <div id="leverageDisplay" class="font-mono-data">1.00x</div>
          </div>
          <div class="glass-card border-t-[6px] border-t-rose-600">
            <span
              >預算總計
              <span
                id="levBadge"
                class="hidden text-xs bg-rose-100 px-2 rounded"
                >LEV</span
              ></span
            >
            <div id="targetTotalRatio" class="font-mono-data">0.0%</div>
          </div>
          <div
            class="glass-card border-t-[6px] border-t-indigo-600"
            id="maintenanceCard"
          >
            <span>質押維持率</span>
            <div id="maintenanceRatio" class="font-mono-data">N/A</div>
          </div>
        </div>

        <div class="params-row-tight mb-10">
          <div class="input-unit">
            <label>貸款/負債 (Loan)</label>
            <div class="input-box">
              <span>$</span
              ><input
                type="number"
                id="debtInput"
                placeholder="0"
                oninput="updateGlobal('totalDebt', this.value)"
              />
            </div>
          </div>
          <div class="input-unit">
            <label>現金餘額 (Cash)</label>
            <div class="input-box">
              <span>$</span
              ><input
                type="number"
                id="cashInput"
                placeholder="0"
                oninput="updateGlobal('currentCash', this.value)"
              />
            </div>
          </div>
          <div class="input-unit-small">
            <label>匯率</label>
            <input
              type="number"
              id="usdRateInput"
              step="0.1"
              class="flat-input"
              oninput="updateGlobal('usdRate', this.value)"
            />
          </div>
          <div class="input-unit-small">
            <label class="text-rose-600">絕對門檻%</label>
            <input
              type="number"
              id="rebalanceAbsInput"
              step="0.1"
              class="flat-input accent-text"
              oninput="updateGlobal('rebalanceAbs', this.value)"
            />
          </div>
          <div class="input-unit-small no-border">
            <label class="text-rose-600">相對門檻%</label>
            <input
              type="number"
              id="rebalanceRelInput"
              step="0.1"
              class="flat-input accent-text"
              oninput="updateGlobal('rebalanceRel', this.value)"
            />
          </div>
        </div>

        <div class="flex-1 overflow-x-auto">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-3xl font-black text-rose-900">
              <i class="fas fa-layer-group mr-4 text-rose-500"></i>標的實時監控
            </h3>
            <div class="flex items-center gap-4">
              <button
                id="btnSyncAll"
                class="px-8 py-4 bg-white border-2 border-rose-300 text-rose-700 font-black rounded-2xl hover:bg-rose-50 flex items-center gap-3"
              >
                <i id="syncIcon" class="fas fa-sync-alt"></i> 更新報價
              </button>
              <button
                id="btnAddAsset"
                class="px-10 py-4 btn-pink rounded-2xl shadow-xl flex items-center gap-3"
              >
                <i class="fas fa-plus"></i> 新增標的
              </button>
            </div>
          </div>
          <table class="auto-table">
            <thead>
              <tr class="text-left text-rose-400 font-black text-xl">
                <th class="px-4">標的 / 名稱</th>
                <th class="px-4 text-center">槓桿</th>
                <th class="px-4">目前單價</th>
                <th class="px-4">持有股數</th>
                <th class="px-4">名目曝險</th>
                <th class="px-4 text-center text-indigo-700">目前%</th>
                <th class="px-4 text-center text-rose-800">目標%</th>
                <th class="px-4 text-center">理想配置</th>
                <th class="px-4 text-center">再平衡建議</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="assetBody"></tbody>
          </table>
        </div>
      </main>
    </div>
    <div
      id="toast"
      class="fixed bottom-10 right-10 px-10 py-5 bg-rose-950 text-white rounded-2xl shadow-2xl opacity-0 z-50 pointer-events-none flex items-center gap-4 font-black text-xl"
    >
      <i class="fas fa-bell text-rose-400"></i> <span id="toastMsg"></span>
    </div>
    <script type="module" src="main.js"></script>
  </body>
</html>
